<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Alumni Cup - Admin Panel</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #f5f5f5;
      padding: 2rem;
    }
    
    .container {
      max-width: 1000px;
      margin: 0 auto;
      background: white;
      padding: 2rem;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    
    h1 {
      color: #bf5700;
      margin-bottom: 0.5rem;
    }
    
    .subtitle {
      color: #666;
      margin-bottom: 2rem;
    }
    
    .section {
      margin-bottom: 3rem;
      padding-bottom: 2rem;
      border-bottom: 2px solid #eee;
    }
    
    .section:last-child {
      border-bottom: none;
    }
    
    h2 {
      color: #00274c;
      margin-bottom: 1.5rem;
      font-size: 1.5rem;
    }
    
    h3 {
      color: #333;
      margin-top: 1.5rem;
      margin-bottom: 1rem;
      font-size: 1.2rem;
    }
    
    .form-group {
      margin-bottom: 1.5rem;
    }
    
    label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: bold;
      color: #333;
    }
    
    input[type="text"],
    input[type="number"],
    input[type="url"],
    textarea,
    select {
      width: 100%;
      padding: 0.8rem;
      border: 1px solid #ddd;
      border-radius: 5px;
      font-size: 1rem;
    }
    
    textarea {
      min-height: 150px;
      resize: vertical;
      font-family: monospace;
    }
    
    .photo-links {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }
    
    .photo-link-item {
      display: flex;
      gap: 0.5rem;
      align-items: center;
    }
    
    .photo-link-item input {
      flex: 1;
    }
    
    .photo-link-item button {
      background: #dc3545;
      padding: 0.5rem 1rem;
      font-size: 0.9rem;
    }
    
    .add-link-btn {
      background: #28a745;
      padding: 0.5rem 1rem;
      margin-top: 0.5rem;
      font-size: 0.9rem;
    }
    
    .photo-preview {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
      gap: 1rem;
      margin-top: 1rem;
    }
    
    .photo-item {
      position: relative;
      border-radius: 5px;
      overflow: hidden;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    
    .photo-item img {
      width: 100%;
      height: 150px;
      object-fit: cover;
    }
    
    button {
      background: #bf5700;
      color: white;
      padding: 1rem 2rem;
      border: none;
      border-radius: 5px;
      font-size: 1rem;
      cursor: pointer;
      font-weight: bold;
      transition: background 0.3s;
    }
    
    button:hover {
      background: #a04900;
    }
    
    .button-group {
      display: flex;
      gap: 1rem;
      margin-top: 1rem;
      flex-wrap: wrap;
    }
    
    .success-message {
      background: #4CAF50;
      color: white;
      padding: 1rem;
      border-radius: 5px;
      margin-top: 1rem;
      display: none;
    }
    
    .info-box {
      background: #e3f2fd;
      padding: 1rem;
      border-radius: 5px;
      margin-bottom: 1rem;
      border-left: 4px solid #2196F3;
    }
    
    .warning-box {
      background: #fff3cd;
      padding: 1rem;
      border-radius: 5px;
      margin-bottom: 1rem;
      border-left: 4px solid #ffc107;
    }
    
    .code-output {
      background: #f5f5f5;
      padding: 1rem;
      border-radius: 5px;
      font-family: monospace;
      font-size: 0.9rem;
      margin-top: 1rem;
      max-height: 400px;
      overflow-y: auto;
      border: 1px solid #ddd;
      white-space: pre-wrap;
      word-wrap: break-word;
    }
    
    .copy-button {
      background: #00274c;
      padding: 0.5rem 1rem;
      font-size: 0.9rem;
    }
    
    .example {
      background: #f8f9fa;
      padding: 0.5rem;
      border-radius: 3px;
      font-family: monospace;
      font-size: 0.85rem;
      margin-top: 0.5rem;
    }
    
    .subsection {
      background: #f9f9f9;
      padding: 1.5rem;
      border-radius: 8px;
      margin-top: 1rem;
    }
    
    table {
      border-collapse: collapse;
    }
    
    table th {
      font-weight: bold;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üèÜ Alumni Cup Admin Panel</h1>
    <p class="subtitle">Manage photos, results, participants, and rules</p>

    <!-- Photo Gallery Section -->
    <div class="section">
      <h2>üì∏ Google Drive Photo Gallery</h2>
      <div class="info-box">
        <strong>How to use Google Drive photos:</strong><br>
        1. Upload photos to Google Drive<br>
        2. Right-click ‚Üí Share ‚Üí "Anyone with the link" (Viewer access)<br>
        3. Copy the share link<br>
        4. Paste it below (the tool will auto-convert it!)
      </div>
      
      <div class="form-group">
        <label>Google Drive Photo Links</label>
        <div class="warning-box" style="font-size: 0.9rem;">
          Paste your Google Drive share links below. Example:<br>
          <span class="example">https://drive.google.com/file/d/1ABC123xyz/view?usp=sharing</span>
        </div>
        <div id="photoLinksContainer" class="photo-links">
          <div class="photo-link-item">
            <input type="url" placeholder="Paste Google Drive share link here" class="photo-link-input">
            <button onclick="removePhotoLink(this)">Remove</button>
          </div>
        </div>
        <button class="add-link-btn" onclick="addPhotoLink()">+ Add Another Photo</button>
      </div>
      
      <div class="button-group">
        <button onclick="previewPhotos()">Preview Photos</button>
        <button onclick="generatePhotoCode()">Generate Photo Gallery Code</button>
        <button class="copy-button" onclick="copyCode('photoCodeOutput')">Copy Code</button>
      </div>
      
      <div class="photo-preview" id="photoPreview"></div>
      
      <div class="code-output" id="photoCodeOutput" style="display: none;"></div>
      <div class="success-message" id="photoSuccess">Photo code generated! Copy and paste into your HTML.</div>
    </div>

    <!-- 2025 Results Section -->
    <div class="section">
      <h2>üèÜ 2025 Results & Detailed Information</h2>
      
      <div class="subsection">
        <h3>Golf Championship Results</h3>
        <div class="form-group">
          <label>UT Austin Golf Score</label>
          <input type="number" id="utGolfScore" value="312">
        </div>
        <div class="form-group">
          <label>Michigan Golf Score</label>
          <input type="number" id="umGolfScore" value="325">
        </div>
        
        <h4 style="margin-top: 1rem; margin-bottom: 0.5rem;">Golf Participants (UT Austin)</h4>
        <div class="info-box" style="font-size: 0.9rem;">
          <strong>How to use:</strong> Paste CSV data from Excel/Google Sheets (Name, Score format). Or type directly in the table below.
        </div>
        <textarea id="utGolfCSV" placeholder="Paste CSV here (Name, Score) or leave blank and use table below
Example:
John Smith, 78
Jane Doe, 82
Bob Johnson, 75" style="min-height: 100px; font-family: monospace; margin-bottom: 0.5rem;"></textarea>
        <button class="add-link-btn" onclick="parseCSV('utGolfCSV', 'utGolfTable')">üìã Parse CSV to Table</button>
        
        <div style="overflow-x: auto; margin-top: 1rem;">
          <table id="utGolfTable" style="width: 100%; border-collapse: collapse; background: white;">
            <thead>
              <tr style="background: #bf5700; color: white;">
                <th style="padding: 0.5rem; text-align: left;">Name</th>
                <th style="padding: 0.5rem; text-align: left;">Score</th>
                <th style="padding: 0.5rem; width: 80px;">Action</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td style="padding: 0.5rem;"><input type="text" placeholder="Name" style="width: 100%; border: 1px solid #ddd; padding: 0.3rem;"></td>
                <td style="padding: 0.5rem;"><input type="number" placeholder="Score" style="width: 100%; border: 1px solid #ddd; padding: 0.3rem;"></td>
                <td style="padding: 0.5rem;"><button onclick="removeTableRow(this)" style="padding: 0.3rem 0.5rem; font-size: 0.85rem;">Remove</button></td>
              </tr>
            </tbody>
          </table>
        </div>
        <button class="add-link-btn" onclick="addTableRow('utGolfTable', 'number')">+ Add Row</button>
        
        <h4 style="margin-top: 2rem; margin-bottom: 0.5rem;">Golf Participants (Michigan)</h4>
        <div class="info-box" style="font-size: 0.9rem;">
          <strong>How to use:</strong> Paste CSV data from Excel/Google Sheets (Name, Score format). Or type directly in the table below.
        </div>
        <textarea id="umGolfCSV" placeholder="Paste CSV here (Name, Score)" style="min-height: 100px; font-family: monospace; margin-bottom: 0.5rem;"></textarea>
        <button class="add-link-btn" onclick="parseCSV('umGolfCSV', 'umGolfTable')">üìã Parse CSV to Table</button>
        
        <div style="overflow-x: auto; margin-top: 1rem;">
          <table id="umGolfTable" style="width: 100%; border-collapse: collapse; background: white;">
            <thead>
              <tr style="background: #00274c; color: white;">
                <th style="padding: 0.5rem; text-align: left;">Name</th>
                <th style="padding: 0.5rem; text-align: left;">Score</th>
                <th style="padding: 0.5rem; width: 80px;">Action</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td style="padding: 0.5rem;"><input type="text" placeholder="Name" style="width: 100%; border: 1px solid #ddd; padding: 0.3rem;"></td>
                <td style="padding: 0.5rem;"><input type="number" placeholder="Score" style="width: 100%; border: 1px solid #ddd; padding: 0.3rem;"></td>
                <td style="padding: 0.5rem;"><button onclick="removeTableRow(this)" style="padding: 0.3rem 0.5rem; font-size: 0.85rem;">Remove</button></td>
              </tr>
            </tbody>
          </table>
        </div>
        <button class="add-link-btn" onclick="addTableRow('umGolfTable', 'number')">+ Add Row</button>
      </div>
      
      <div class="subsection">
        <h3>10K Run Championship Results</h3>
        <div class="form-group">
          <label>UT Austin Average Time (mm:ss)</label>
          <input type="text" id="ut10kTime" value="49:15" placeholder="49:15">
        </div>
        <div class="form-group">
          <label>Michigan Average Time (mm:ss)</label>
          <input type="text" id="um10kTime" value="48:23" placeholder="48:23">
        </div>
        
        <h4 style="margin-top: 1rem; margin-bottom: 0.5rem;">10K Participants (UT Austin)</h4>
        <div class="info-box" style="font-size: 0.9rem;">
          <strong>How to use:</strong> Paste CSV data (Name, Time). Time format: mm:ss (e.g., 48:23)
        </div>
        <textarea id="ut10kCSV" placeholder="Paste CSV here (Name, Time)
Example:
John Smith, 48:23
Jane Doe, 52:15
Bob Johnson, 45:30" style="min-height: 100px; font-family: monospace; margin-bottom: 0.5rem;"></textarea>
        <button class="add-link-btn" onclick="parseCSV('ut10kCSV', 'ut10kTable')">üìã Parse CSV to Table</button>
        
        <div style="overflow-x: auto; margin-top: 1rem;">
          <table id="ut10kTable" style="width: 100%; border-collapse: collapse; background: white;">
            <thead>
              <tr style="background: #bf5700; color: white;">
                <th style="padding: 0.5rem; text-align: left;">Name</th>
                <th style="padding: 0.5rem; text-align: left;">Time (mm:ss)</th>
                <th style="padding: 0.5rem; width: 80px;">Action</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td style="padding: 0.5rem;"><input type="text" placeholder="Name" style="width: 100%; border: 1px solid #ddd; padding: 0.3rem;"></td>
                <td style="padding: 0.5rem;"><input type="text" placeholder="48:23" style="width: 100%; border: 1px solid #ddd; padding: 0.3rem;"></td>
                <td style="padding: 0.5rem;"><button onclick="removeTableRow(this)" style="padding: 0.3rem 0.5rem; font-size: 0.85rem;">Remove</button></td>
              </tr>
            </tbody>
          </table>
        </div>
        <button class="add-link-btn" onclick="addTableRow('ut10kTable', 'text')">+ Add Row</button>
        
        <h4 style="margin-top: 2rem; margin-bottom: 0.5rem;">10K Participants (Michigan)</h4>
        <div class="info-box" style="font-size: 0.9rem;">
          <strong>How to use:</strong> Paste CSV data (Name, Time). Time format: mm:ss
        </div>
        <textarea id="um10kCSV" placeholder="Paste CSV here (Name, Time)" style="min-height: 100px; font-family: monospace; margin-bottom: 0.5rem;"></textarea>
        <button class="add-link-btn" onclick="parseCSV('um10kCSV', 'um10kTable')">üìã Parse CSV to Table</button>
        
        <div style="overflow-x: auto; margin-top: 1rem;">
          <table id="um10kTable" style="width: 100%; border-collapse: collapse; background: white;">
            <thead>
              <tr style="background: #00274c; color: white;">
                <th style="padding: 0.5rem; text-align: left;">Name</th>
                <th style="padding: 0.5rem; text-align: left;">Time (mm:ss)</th>
                <th style="padding: 0.5rem; width: 80px;">Action</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td style="padding: 0.5rem;"><input type="text" placeholder="Name" style="width: 100%; border: 1px solid #ddd; padding: 0.3rem;"></td>
                <td style="padding: 0.5rem;"><input type="text" placeholder="48:23" style="width: 100%; border: 1px solid #ddd; padding: 0.3rem;"></td>
                <td style="padding: 0.5rem;"><button onclick="removeTableRow(this)" style="padding: 0.3rem 0.5rem; font-size: 0.85rem;">Remove</button></td>
              </tr>
            </tbody>
          </table>
        </div>
        <button class="add-link-btn" onclick="addTableRow('um10kTable', 'text')">+ Add Row</button>
      </div>
      
      <div class="subsection">
        <h3>Rules & Additional Information</h3>
        <div class="form-group">
          <label>Golf Rules (English)</label>
          <textarea id="golfRulesEn" placeholder="Enter golf rules, scoring format, handicap system, etc.">- USGA Rules apply
- Modified Stableford scoring
- Maximum handicap: 36
- Best 5 scores count for team total</textarea>
        </div>
        
        <div class="form-group">
          <label>Golf Rules (Korean)</label>
          <textarea id="golfRulesKo" placeholder="Í≥®ÌîÑ Í∑úÏπôÏùÑ ÌïúÍµ≠Ïñ¥Î°ú ÏûÖÎ†•ÌïòÏÑ∏Ïöî">- USGA Í∑úÏπô Ï†ÅÏö©
- ÏàòÏ†ïÎêú Ïä§ÌÖåÏù¥Î∏îÌè¨Îìú Ïä§ÏΩîÏñ¥ÎßÅ
- ÏµúÎåÄ Ìï∏ÎîîÏ∫°: 36
- ÌåÄ Ï¥ùÏ†êÏùÄ ÏÉÅÏúÑ 5Î™ÖÏùò Ï†êÏàòÎ°ú Í≥ÑÏÇ∞</textarea>
        </div>
        
        <div class="form-group">
          <label>10K Run Rules (English)</label>
          <textarea id="runRulesEn" placeholder="Enter 10K run rules, timing system, course details, etc.">- Chip-timed race
- USATF certified course
- Top 3 finishers per team count for team score
- Water stations every 2K</textarea>
        </div>
        
        <div class="form-group">
          <label>10K Run Rules (Korean)</label>
          <textarea id="runRulesKo" placeholder="10K ÎßàÎùºÌÜ§ Í∑úÏπôÏùÑ ÌïúÍµ≠Ïñ¥Î°ú ÏûÖÎ†•ÌïòÏÑ∏Ïöî">- Ïπ© ÌÉÄÏù¥Î∞ç Î†àÏù¥Ïä§
- USATF Ïù∏Ï¶ù ÏΩîÏä§
- ÌåÄ Ï†êÏàòÎäî ÏÉÅÏúÑ 3Î™ÖÏúºÎ°ú Í≥ÑÏÇ∞
- 2KÎßàÎã§ Í∏âÏàòÎåÄ Ï†úÍ≥µ</textarea>
        </div>
      </div>
      
      <div class="form-group">
        <label>Total Participants</label>
        <input type="number" id="totalParticipants" value="100">
      </div>
      
      <div class="form-group">
        <label>Additional Notes (optional)</label>
        <textarea id="resultNotes" placeholder="Any special highlights or notes about the 2025 event..." style="min-height: 80px;"></textarea>
      </div>
      
      <div class="button-group">
        <button onclick="generateResultsCode()">Generate Complete Results Code</button>
        <button class="copy-button" onclick="copyCode('resultsCodeOutput')">Copy Code</button>
      </div>
      
      <div class="code-output" id="resultsCodeOutput" style="display: none;"></div>
      <div class="success-message" id="resultsSuccess">Results code generated!</div>
    </div>

    <!-- Event Announcement Section -->
    <div class="section">
      <h2>üì¢ Update Announcement Banner</h2>
      
      <div class="form-group">
        <label>Announcement Text (English)</label>
        <input type="text" id="announcementEn" value="üéâ Alumni Cup 2026 - Expanding to 4 Schools! Registration Opens March 2026">
      </div>
      
      <div class="form-group">
        <label>Announcement Text (Korean)</label>
        <input type="text" id="announcementKo" value="üéâ ÏïåÎüºÎÇòÏù¥ Ïªµ 2026 - 4Í∞ú ÎåÄÌïôÏúºÎ°ú ÌôïÎåÄ! Îì±Î°ùÏùÄ 2026ÎÖÑ 3Ïõî ÏãúÏûë">
      </div>
      
      <div class="button-group">
        <button onclick="generateAnnouncementCode()">Generate Announcement Code</button>
        <button class="copy-button" onclick="copyCode('announcementCodeOutput')">Copy Code</button>
      </div>
      
      <div class="code-output" id="announcementCodeOutput" style="display: none;"></div>
      <div class="success-message" id="announcementSuccess">Announcement code generated!</div>
    </div>

    <!-- Instructions -->
    <div class="section">
      <h2>üìù How to Update Your Website</h2>
      <ol style="line-height: 2; margin-left: 1.5rem;">
        <li><strong>Fill in all the information</strong> in the sections above (photos, participants via CSV paste, rules, etc.)</li>
        <li>Click "Generate Code" for each section you want to update</li>
        <li>Click "Copy Code" to copy the generated HTML</li>
        <li>Go to your GitHub repository: <code>https://github.com/johnyohankim/alumnicup</code></li>
        <li>Click on <code>index.html</code> and then the pencil icon (Edit)</li>
        <li>Find the section marked in the comments (e.g., <code>&lt;!-- Results Section --&gt;</code>)</li>
        <li>Replace that entire section with your new generated code</li>
        <li>Scroll down and click "Commit changes"</li>
        <li>Wait 2-3 minutes and your site will be updated!</li>
      </ol>
      
      <div class="info-box" style="margin-top: 1rem;">
        <strong>Tip:</strong> You can paste CSV data directly from Excel or Google Sheets! Just copy the Name and Score columns and paste into the textareas.
      </div>
    </div>
  </div>

  <script>
    // Photo Link Functions
    function addPhotoLink() {
      const container = document.getElementById('photoLinksContainer');
      const newItem = document.createElement('div');
      newItem.className = 'photo-link-item';
      newItem.innerHTML = `
        <input type="url" placeholder="Paste Google Drive share link here" class="photo-link-input">
        <button onclick="removePhotoLink(this)">Remove</button>
      `;
      container.appendChild(newItem);
    }

    function removePhotoLink(button) {
      const container = document.getElementById('photoLinksContainer');
      if (container.children.length > 1) {
        button.parentElement.remove();
      } else {
        alert('You must have at least one photo link field!');
      }
    }

    // Table Functions
    function addTableRow(tableId, inputType) {
      const table = document.getElementById(tableId);
      const tbody = table.querySelector('tbody');
      const newRow = tbody.insertRow();
      
      newRow.innerHTML = `
        <td style="padding: 0.5rem;"><input type="text" placeholder="Name" style="width: 100%; border: 1px solid #ddd; padding: 0.3rem;"></td>
        <td style="padding: 0.5rem;"><input type="${inputType}" placeholder="${inputType === 'number' ? 'Score' : '48:23'}" style="width: 100%; border: 1px solid #ddd; padding: 0.3rem;"></td>
        <td style="padding: 0.5rem;"><button onclick="removeTableRow(this)" style="padding: 0.3rem 0.5rem; font-size: 0.85rem;">Remove</button></td>
      `;
    }
    
    function removeTableRow(button) {
      const row = button.closest('tr');
      const tbody = row.parentElement;
      if (tbody.rows.length > 1) {
        row.remove();
      } else {
        alert('Must have at least one row!');
      }
    }
    
    function parseCSV(textareaId, tableId) {
      const textarea = document.getElementById(textareaId);
      const table = document.getElementById(tableId);
      const tbody = table.querySelector('tbody');
      const csvData = textarea.value.trim();
      
      if (!csvData) {
        alert('Please paste CSV data first!');
        return;
      }
      
      tbody.innerHTML = '';
      
      const lines = csvData.split('\n');
      const inputType = tableId.includes('Golf') ? 'number' : 'text';
      
      lines.forEach(line => {
        const trimmedLine = line.trim();
        if (!trimmedLine) return;
        
        const parts = trimmedLine.split(',').map(p => p.trim());
        if (parts.length >= 2) {
          const newRow = tbody.insertRow();
          newRow.innerHTML = `
            <td style="padding: 0.5rem;"><input type="text" value="${parts[0]}" style="width: 100%; border: 1px solid #ddd; padding: 0.3rem;"></td>
            <td style="padding: 0.5rem;"><input type="${inputType}" value="${parts[1]}" style="width: 100%; border: 1px solid #ddd; padding: 0.3rem;"></td>
            <td style="padding: 0.5rem;"><button onclick="removeTableRow(this)" style="padding: 0.3rem 0.5rem; font-size: 0.85rem;">Remove</button></td>
          `;
        }
      });
      
      textarea.value = '';
      alert('CSV data parsed successfully! Review the table and make any edits needed.');
    }
    
    function getTableData(tableId) {
      const table = document.getElementById(tableId);
      const tbody = table.querySelector('tbody');
      const rows = tbody.querySelectorAll('tr');
      const data = [];
      
      rows.forEach(row => {
        const inputs = row.querySelectorAll('input');
        const name = inputs[0].value.trim();
        const score = inputs[1].value.trim();
        if (name && score) {
          data.push({ name, score });
        }
      });
      
      return data;
    }

    // Google Drive Link Conversion
    function convertGoogleDriveLink(url) {
      if (!url || url.trim() === '') return null;
      
      let fileId = null;
      const match1 = url.match(/\/file\/d\/([^\/]+)/);
      if (match1) fileId = match1[1];
      
      const match2 = url.match(/[?&]id=([^&]+)/);
      if (match2) fileId = match2[1];
      
      if (fileId) {
        return `https://drive.google.com/uc?export=view&id=${fileId}`;
      }
      
      return url;
    }

    function previewPhotos() {
      const inputs = document.querySelectorAll('.photo-link-input');
      const preview = document.getElementById('photoPreview');
      preview.innerHTML = '';
      
      let hasPhotos = false;
      inputs.forEach(input => {
        const url = convertGoogleDriveLink(input.value);
        if (url) {
          hasPhotos = true;
          const div = document.createElement('div');
          div.className = 'photo-item';
          div.innerHTML = `<img src="${url}" alt="Event Photo" onerror="this.src='data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%22150%22 height=%22150%22><rect fill=%22%23ddd%22 width=%22150%22 height=%22150%22/><text x=%2250%%22 y=%2250%%22 text-anchor=%22middle%22 dy=%22.3em%22 fill=%22%23999%22>Invalid Link</text></svg>'">`;
          preview.appendChild(div);
        }
      });
      
      if (!hasPhotos) {
        alert('Please add at least one Google Drive photo link!');
      }
    }

    function generatePhotoCode() {
      const inputs = document.querySelectorAll('.photo-link-input');
      const photoUrls = [];
      
      inputs.forEach(input => {
        const url = convertGoogleDriveLink(input.value);
        if (url) photoUrls.push(url);
      });
      
      if (photoUrls.length === 0) {
        alert('Please add at least one Google Drive photo link!');
        return;
      }
      
      let code = `<!-- Photo Gallery Section - Insert this AFTER the dropdown details section -->
<div style="margin-top: 3rem;">
  <h3 style="text-align: center; color: #00274c; font-size: 1.8rem; margin-bottom:
